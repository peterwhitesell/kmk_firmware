#!/bin/bash

SIDE=$1
if [[ "$SIDE" != "L" ]] && [[ "$SIDE" != "R" ]]; then
    echo "Usage: hack/init L|R"
    exit 1
fi

DIR="$(dirname ${BASH_SOURCE[0]})"
KB_DRIVE=/Volumes/KB_$SIDE
MAIN_PY=$DIR/../boards/pwhitesell/main.py
RGB_KEYS=$DIR/../kmk/modules/rgbkeys.py
PMW=$DIR/../kmk/modules/pmw3360.py
CAPSWORD=$DIR/../kmk/modules/capsword.py
SPLIT=$DIR/../kmk/modules/split.py
RGB=$DIR/../kmk/extensions/rgb.py
KB=$DIR/../kmk/kmk_keyboard.py

cp -X $MAIN_PY $KB_DRIVE
for m in $RGB_KEYS $PMW $SPLIT; do
    echo copying $m
    cp -X $m $KB_DRIVE/kmk/modules
done
for e in $RGB; do
    echo copying $e
    cp -X $e $KB_DRIVE/kmk/extensions
done
for f in $(ls $DIR/../kmk | grep ".py"); do
    echo copying $f
    cp -X $DIR/../kmk/$f $KB_DRIVE/kmk/
done
# cp -X $KB $KB_DRIVE/kmk